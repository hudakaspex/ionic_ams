{"version":3,"sources":["../../src/pages/site-list/site-list.module.ts","../../src/components/loading/loading.ts","../../src/components/alert/alert.ts","../../src/components/components.module.ts","../../src/components/logout/logout.ts","../../src/components/public_ip.ts","../../src/pages/site-list/site-list.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SiteListPage } from './site-list';\nimport { ComponentsModule } from '../../components/components.module';\n\n@NgModule({\n  declarations: [\n    SiteListPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SiteListPage),\n    ComponentsModule\n  ],\n})\nexport class SiteListPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/site-list/site-list.module.ts","import { Component } from '@angular/core';\nimport { LoadingController, Loading } from 'ionic-angular';\n\n@Component({\n  selector: 'loading',\n  templateUrl: 'loading.html'\n})\nexport class LoadingComponent {\n\n  constructor(private loadingCtrl: LoadingController) { }\n\n  loadingDuration(content: string, duration: number): Loading {\n    let loading: Loading = this.loadingCtrl.create({\n      content: content,\n      duration: duration\n    })\n    loading.present();\n    return loading\n  }\n\n  loading(content: string): Loading {\n    let loading: Loading = this.loadingCtrl.create({\n      content: content\n    })\n    return loading\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/loading/loading.ts","import { Component } from '@angular/core';\nimport { AlertController, AlertOptions } from 'ionic-angular';\n\n@Component({\n  selector: 'alert',\n  template: ''\n})\nexport class AlertComponent {\n\n\n  constructor(private alertCtrl:AlertController) {}\n\n  public messageAlert(alertOption:AlertOptions):void{\n    let alert = this.alertCtrl.create({\n      title : alertOption['title'],\n      message : alertOption['message'],\n      buttons : ['OK']\n    }).present();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/alert/alert.ts","import { NgModule } from '@angular/core';\nimport { AlertComponent } from './alert/alert';\nimport { LoadingComponent } from './loading/loading';\nimport { IonicModule } from 'ionic-angular';\nimport { LogoutComponent } from './logout/logout';\n\n@NgModule({\n\tdeclarations: [\n\t\tAlertComponent,\n\t\tLoadingComponent,\n\t\tLogoutComponent\n\t],\n\timports: [],\n\texports: [\n\t\tAlertComponent,\n\t\tLoadingComponent,\n\t\tIonicModule,\n\t\tLogoutComponent\n\t],\n\tproviders: [\n\t\tLoadingComponent,\n\t]\n})\nexport class ComponentsModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/components.module.ts","import { Component } from \"@angular/core\";\nimport { LocalstorageProvider } from \"../../providers/localstorage/localstorage\";\nimport { PushNotificationProvider } from \"../../providers/push-notification/push-notification\";\n\n@Component({\n  selector: \"logout\",\n  templateUrl: \"logout.html\"\n})\nexport class LogoutComponent {\n  constructor(\n    private storage: LocalstorageProvider,\n    private notification: PushNotificationProvider\n  ) {}\n\n  run(): Promise<any> {\n    return new Promise((resolve, reject) => {\n      this.storage.get(\"securitySite\")\n        .then(result => {\n          for (let i of result) {\n            this.storage.delete(\"user\", { userId: i[\"id\"] })\n              .then(result => {\n                this.storage.delete(\"securitySite\", { id: i[\"id\"] })\n                  .then(result => {\n                    this.deleteSecuritySites().then(result => {\n                      this.deleteSite().then(result=>{\n                        resolve(true)\n                      })\n                      .catch(err=> reject(err));\n                    })\n                    .catch(err=> reject(err))\n                  })\n                  .catch(err => { reject(err) });\n              })\n              .catch(err => { reject(err) });\n          }\n        })\n        .catch(err => reject(err));\n    });\n  }\n\n  deleteSecuritySites(): Promise<boolean> {\n    return new Promise((resolve, reject) => {\n      this.storage\n        .get(\"securitySites\")\n        .then(result => {\n          for (let i of result) {\n            this.storage\n              .delete(\"securitySites\", { id: i[\"id\"] })\n              .then(result => {\n                resolve(true);\n              })\n              .catch(err => reject(err));\n          }\n        })\n        .catch(err => reject(err));\n    });\n  }\n\n  deleteSite(): Promise<boolean> {\n    return new Promise((resolve, reject) => {\n      this.storage.get(\"site\")\n        .then(result => {\n          for (let i of result) {\n            this.notification.unsubscribeTopic(i[\"label\"])\n              .then(unsubscribe => {\n                this.storage.delete(\"site\", { id: i[\"id\"] })\n                  .then(result => {\n                    resolve(true);\n                  })\n                  .catch(err => reject(err));\n              })\n              .catch(err => reject(err));\n          }\n        })\n        .catch(err => reject(err));\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/logout/logout.ts","export const emsDeploy: string = \"http://ems-protelindo.ddns.net\";\n// export const emsDevelop: string = \"http://alfademo.ddns.net\";\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/public_ip.ts","import { Component } from \"@angular/core\";\nimport { IonicPage, NavController, NavParams } from \"ionic-angular\";\nimport { HttpClient, HttpErrorResponse } from \"@angular/common/http\";\nimport { Platform } from \"ionic-angular/platform/platform\";\nimport { LocalstorageProvider } from \"../../providers/localstorage/localstorage\";\nimport { emsDeploy } from \"../../components/public_ip\";\nimport { PushNotificationProvider } from \"../../providers/push-notification/push-notification\";\nimport { LoadingComponent } from \"../../components/loading/loading\";\nimport { alarmActive } from \"../../components/interface\";\n\n@IonicPage()\n@Component({\n  selector: \"page-site-list\",\n  templateUrl: \"site-list.html\"\n})\nexport class SiteListPage {\n  userList: Array<Object> = [];\n  siteList: Array<Object> = [];\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public http: HttpClient,\n    public platform: Platform,\n    public storage: LocalstorageProvider,\n    public notification: PushNotificationProvider,\n    public loading: LoadingComponent\n  ) {}\n\n  ionViewDidLoad() {\n    this.getListSite();\n  }\n\n  getListSite(): void {\n    let loading = this.loading.loading(\"Please wait\");\n    loading.present();\n    this.platform.ready().then(() => {\n      this.storage.get(\"user\").then(result => {\n        if (result.length != 0) {\n          let config: Object = {\n            where: { id: result[0].userId },\n            include: {\n              relation: \"securitySites\",\n              scope: { include: [\"site\"] }\n            }\n          };\n          let filter = encodeURIComponent(JSON.stringify(config));\n          this.http\n            .get(`${emsDeploy}/api/securities/findOne?filter=${filter}`)\n            .subscribe(\n              user => {\n                loading.dismiss();\n                this.userList.push(user);\n                user[\"securitySites\"].forEach(data => {\n                  this.notification\n                    .subscribeTopic(data[\"site\"].label)\n                    .then(result => console.log(result));\n                  this.siteList.push(data);\n                });\n                this.getAlarm();\n              },\n              (error: HttpErrorResponse) => {\n                loading.dismiss();\n                this.navCtrl.setRoot(\"LoginPage\");\n              }\n            );\n        } else {\n          loading.dismiss();\n          this.navCtrl.setRoot(\"LoginPage\");\n        }\n      });\n    });\n  }\n\n  getAlarm(): void {\n    this.userList.forEach(user => {\n      for (let loc of user[\"securitySites\"]) {\n        let lat: string = loc[\"site\"].location[\"lat\"];\n        let lng: string = loc[\"site\"].location[\"lng\"];\n        this.http\n          .get<alarmActive[]>(`${emsDeploy}/api/alarms/${lat}/${lng}`)\n          .subscribe(\n            result => {\n              let alarmsecurity = result.filter(function(type) {\n                return type.type == \"Security\";\n              });\n              loc[\"alarmLength\"] = alarmsecurity.length;\n            },\n            (err: HttpErrorResponse) => {\n              loc[\"alarmLength\"] = 0;\n              console.log(err);\n            }\n          );\n      }\n    });\n  }\n\n  mainPageRoot(siteData: Object): void {\n    for (let user of this.userList) {\n      if (user[\"id\"] == siteData[\"security_id\"]) {\n        let site = user;\n        site[\"securitySites\"] = siteData;\n        this.navCtrl.push(\"TabsPage\", { site: site });\n      }\n    }\n  }\n\n  appLogout() {\n    let loading = this.loading.loadingDuration(\"Please Wait\", 1000);\n    this.storage.get(\"user\").then(result => {\n      for (let i in result) {\n        this.storage.delete(\"user\", { userId: result[i].userId }).then();\n        loading.onDidDismiss(() => {\n          this.navCtrl.setRoot(\"LoginPage\");\n        });\n      }\n    });\n    this.siteList.forEach(siteList => {\n      this.notification\n        .unsubscribeTopic(siteList[\"site\"].label)\n        .then(result => {\n          console.log(result);\n        });\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/site-list/site-list.ts"],"sourceRoot":""}